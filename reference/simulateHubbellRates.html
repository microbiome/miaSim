<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hubbell's neutral model simulation applied to time series — simulateHubbellRates • miaSim</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Hubbell's neutral model simulation applied to time series — simulateHubbellRates"><meta name="description" content="Neutral species abundances simulation according to the Hubbell model. This
model shows that losses in society can be replaced either by the birth of
individuals or by immigration depending on their probabilities.
The specific time between the events of birth or migration is calculated and
time effect is considered to determine the next event."><meta property="og:description" content="Neutral species abundances simulation according to the Hubbell model. This
model shows that losses in society can be replaced either by the birth of
individuals or by immigration depending on their probabilities.
The specific time between the events of birth or migration is calculated and
time effect is considered to determine the next event."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">miaSim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.9.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/miaSim.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/microbiome/miaSim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Hubbell's neutral model simulation applied to time series</h1>
      <small class="dont-index">Source: <a href="https://github.com/microbiome/miaSim/blob/harm/R/simulateHubbellRates.R" class="external-link"><code>R/simulateHubbellRates.R</code></a></small>
      <div class="d-none name"><code>simulateHubbellRates.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Neutral species abundances simulation according to the Hubbell model. This
model shows that losses in society can be replaced either by the birth of
individuals or by immigration depending on their probabilities.
The specific time between the events of birth or migration is calculated and
time effect is considered to determine the next event.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simulateHubbellRates</span><span class="op">(</span></span>
<span>  n_species <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  names_species <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  migration_p <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  metacommunity_probability <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  k_events <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  growth_rates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  error_variance <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  norm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  t_end <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n-species">n_species<a class="anchor" aria-label="anchor" href="#arg-n-species"></a></dt>
<dd><p>Integer: number of species</p></dd>


<dt id="arg-x-">x0<a class="anchor" aria-label="anchor" href="#arg-x-"></a></dt>
<dd><p><code>Numeric scalar</code>. Indicates the initial species
composition. If <code>NULL</code>, <code>rep(100, n_species)</code> is used.</p></dd>


<dt id="arg-names-species">names_species<a class="anchor" aria-label="anchor" href="#arg-names-species"></a></dt>
<dd><p>Character: names of species. If NULL,
<code>paste0("sp", seq_len(n_species))</code> is used.
(default: <code>names_species = NULL</code>)</p></dd>


<dt id="arg-migration-p">migration_p<a class="anchor" aria-label="anchor" href="#arg-migration-p"></a></dt>
<dd><p>Numeric: the probability/frequency of migration from a
metacommunity.
(default: <code>migration_p = 0.01</code>)</p></dd>


<dt id="arg-metacommunity-probability">metacommunity_probability<a class="anchor" aria-label="anchor" href="#arg-metacommunity-probability"></a></dt>
<dd><p>Numeric: Normalized probability distribution
of the likelihood that species from the metacommunity can enter the community
during the simulation. If NULL, <code>rdirichlet(1, alpha = rep(1,n_species))</code> is
used.
(default: <code>metacommunity_probability = NULL</code>)</p></dd>


<dt id="arg-k-events">k_events<a class="anchor" aria-label="anchor" href="#arg-k-events"></a></dt>
<dd><p><code>Integer scalar</code>. Indicates the number of
events to simulate before updating the sampling distributions.
(Default: <code>1</code>)</p></dd>


<dt id="arg-growth-rates">growth_rates<a class="anchor" aria-label="anchor" href="#arg-growth-rates"></a></dt>
<dd><p><code>Numeric scalar</code>. Indicates the maximum
growth rates(mu) of species. If <code>NULL</code>, <code>rep(1, n_species)</code> is used.
(Default: <code>NULL</code>)</p></dd>


<dt id="arg-error-variance">error_variance<a class="anchor" aria-label="anchor" href="#arg-error-variance"></a></dt>
<dd><p>Numeric: the variance of measurement error.
By default it equals to 0, indicating that the result won't contain any
measurement error. This value should be non-negative.
(default: <code>error_variance = 0</code>)</p></dd>


<dt id="arg-norm">norm<a class="anchor" aria-label="anchor" href="#arg-norm"></a></dt>
<dd><p>Logical: whether the time series should be returned with
the abundances as proportions (<code>norm = TRUE</code>) or
the raw counts (default: <code>norm = FALSE</code>)
(default: <code>norm = FALSE</code>)</p></dd>


<dt id="arg-t-end">t_end<a class="anchor" aria-label="anchor" href="#arg-t-end"></a></dt>
<dd><p>Numeric: the end time of the simulationTimes, defining the
modeled time length of the community.
(default: <code>t_end = 1000</code>)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional parameters, see <code><a href="https://rdrr.io/r/utils/utils-package.html" class="external-link">utils</a></code> to know more.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>simulateHubbellRates</code> returns a TreeSummarizedExperiment class
object</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Rosindell, James et al. "The unified neutral theory of
biodiversity and biogeography at age ten." Trends in ecology &amp; evolution
vol. 26,7 (2011).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="fu">simulateHubbellRates</span><span class="op">(</span>n_species <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">miaViz</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/miaViz/man/plotSeries.html" class="external-link">plotSeries</a></span><span class="op">(</span><span class="va">tse</span>, x <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to max; returning -Inf</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to max; returning -Inf</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to max; returning -Inf</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to max; returning -Inf</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to max; returning -Inf</span>
<span class="r-plt img"><img src="simulateHubbellRates-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># no migration, all stochastic birth and death</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tse1</span> <span class="op">&lt;-</span> <span class="fu">simulateHubbellRates</span><span class="op">(</span>n_species <span class="op">=</span> <span class="fl">5</span>, migration_p <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># all migration, no stochastic birth and death</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tse2</span> <span class="op">&lt;-</span> <span class="fu">simulateHubbellRates</span><span class="op">(</span></span></span>
<span class="r-in"><span>    n_species <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>    migration_p <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    metacommunity_probability <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.2</span>, <span class="fl">0.25</span>, <span class="fl">0.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    t_end <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    t_store <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># all migration, no stochastic birth and death, but with measurement errors</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tse3</span> <span class="op">&lt;-</span> <span class="fu">simulateHubbellRates</span><span class="op">(</span></span></span>
<span class="r-in"><span>    n_species <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>    migration_p <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    metacommunity_probability <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.2</span>, <span class="fl">0.25</span>, <span class="fl">0.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    t_end <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    t_store <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>    error_variance <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model with specified inputs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tse4</span> <span class="op">&lt;-</span> <span class="fu">simulateHubbellRates</span><span class="op">(</span></span></span>
<span class="r-in"><span>    n_species <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>    migration_p <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>    metacommunity_probability <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.2</span>, <span class="fl">0.25</span>, <span class="fl">0.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    t_end <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>    t_store <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>    k_events <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>    growth_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="fl">1.05</span>, <span class="fl">1</span>, <span class="fl">0.95</span>, <span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yagmur Simsek, Karoline Faust, Yu Gao, Emma Gheysen, Daniel Rios Garza, Tuomas Borman, Leo Lahti.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

