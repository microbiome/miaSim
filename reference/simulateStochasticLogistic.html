<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Stochastic Logistic simulation — simulateStochasticLogistic • miaSim</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Stochastic Logistic simulation — simulateStochasticLogistic"><meta property="og:description" content="Simulates a community time series using the logistic model.
The change rate of the species was defined as
dx/dt = b*x*(1-(x/k))*rN - dr*x, where
b is the vector of growth rates,
x is the vector of initial species abundances,
k is the vector of maximum carrying capacities,
rN is a random number ranged from 0 to 1 which changes in each time step,
dr is the vector of constant death rates.
Also, the vectors of initial dead species abundances can be set.
The number of species will be set to 0 if the dead species abundances
surpass the alive species abundances."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">miaSim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/miaSim.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/microbiome/miaSim/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Stochastic Logistic simulation</h1>
    <small class="dont-index">Source: <a href="https://github.com/microbiome/miaSim/blob/HEAD/R/simulateStochasticLogistic.R" class="external-link"><code>R/simulateStochasticLogistic.R</code></a></small>
    <div class="hidden name"><code>simulateStochasticLogistic.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulates a community time series using the logistic model.
The change rate of the species was defined as
<code>dx/dt = b*x*(1-(x/k))*rN - dr*x</code>, where
b is the vector of growth rates,
x is the vector of initial species abundances,
k is the vector of maximum carrying capacities,
rN is a random number ranged from 0 to 1 which changes in each time step,
dr is the vector of constant death rates.
Also, the vectors of initial dead species abundances can be set.
The number of species will be set to 0 if the dead species abundances
surpass the alive species abundances.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simulateStochasticLogistic</span><span class="op">(</span></span>
<span>  <span class="va">n_species</span>,</span>
<span>  b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_species</span>, min <span class="op">=</span> <span class="fl">0.1</span>, max <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_species</span>, min <span class="op">=</span> <span class="fl">1000</span>, max <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span>,</span>
<span>  dr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_species</span>, min <span class="op">=</span> <span class="fl">5e-04</span>, max <span class="op">=</span> <span class="fl">0.0025</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_species</span>, min <span class="op">=</span> <span class="fl">0.1</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  sigma_drift <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  sigma_epoch <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  sigma_external <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  p_epoch <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  t_external_events <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">240</span>, <span class="fl">480</span><span class="op">)</span>,</span>
<span>  t_external_durations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  stochastic <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  t_end <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>n_species</dt>
<dd><p>integer number of species</p></dd>


<dt>b</dt>
<dd><p>numeric growth rates
(default: <code>b = runif(n = n_species, min = 0.1, max = 0.2)</code>)</p></dd>


<dt>k</dt>
<dd><p>numeric value of carrying capacities
(default: <code>k = runif(n = n_species, min = 1000, max = 2000)</code>)</p></dd>


<dt>dr</dt>
<dd><p>numeric value of death rates
(default: <code>dr = runif(n = n_species, min = 0.0005, max = 0.0025)</code>)</p></dd>


<dt>x</dt>
<dd><p>numeric initial abundances
(default: <code>x = runif(n = n_species, min = 0.1, max = 10)</code>)</p></dd>


<dt>sigma_drift</dt>
<dd><p>numeric degree of drift (turnover of species) in each
time step.
(default: <code>sigma_drift = 0.001</code>)</p></dd>


<dt>sigma_epoch</dt>
<dd><p>numeric degree of epoch change of community
(default: <code>sigma_epoch = 0.1</code>)</p></dd>


<dt>sigma_external</dt>
<dd><p>numeric degree of external events/disturbances
(default: <code>sigma_external = 0.3</code>)</p></dd>


<dt>p_epoch</dt>
<dd><p>numeric value of probability/frequency of inherit periodic
changes of community (default: <code>p_epoch = 0.001</code>)</p></dd>


<dt>t_external_events</dt>
<dd><p>numeric value of starting times of external events
(default: <code>t_external_events = c(0, 240, 480)</code>)</p></dd>


<dt>t_external_durations</dt>
<dd><p>numeric value of durations of external events
(default: <code>t_external_durations = c(0, 1, 1)</code>)</p></dd>


<dt>stochastic</dt>
<dd><p>logical scalar choosing whether the logistic model should
be stochastic (controlled by multiplying the growth rate by a random number)
(default: <code>stochastic = TRUE</code>)</p></dd>


<dt>t_end</dt>
<dd><p>numeric final time of the simulation
(default: <code>t_end = 1000</code>)</p></dd>


<dt>...</dt>
<dd><p>additional parameters including 't_start', 't_step', and 't_store'</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>simulateStochasticLogistic</code> returns an abundance matrix with
species abundance as rows and time points as columns</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="convertToSE.html">convertToSE</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## ATTENTION: Don't set a large value to t.step, otherwise the computer won't</span></span></span>
<span class="r-in"><span><span class="co">#give a correct solution to the logistic ODE(ordinary differential equation).</span></span></span>
<span class="r-in"><span><span class="co">#Keeping t_step under 0.05 or 0.01 is a good practice.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#while (!exists("ExampleLogistic"))</span></span></span>
<span class="r-in"><span><span class="va">ExampleLogistic</span> <span class="op">&lt;-</span> <span class="fu">simulateStochasticLogistic</span><span class="op">(</span>n_species <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#plot the calculated points</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">ExampleLogistic</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="simulateStochasticLogistic-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#calculation by setting initial parameters explicitly</span></span></span>
<span class="r-in"><span><span class="va">ExampleLogistic2</span> <span class="op">&lt;-</span> <span class="fu">simulateStochasticLogistic</span><span class="op">(</span>n_species <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span>, k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">2000</span><span class="op">)</span>, dr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.0015</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>sigma_drift <span class="op">=</span> <span class="fl">0.001</span>, sigma_epoch <span class="op">=</span> <span class="fl">0.3</span>, sigma_external <span class="op">=</span> <span class="fl">0.5</span>,p_epoch <span class="op">=</span> <span class="fl">0.001</span>,</span></span>
<span class="r-in"><span>t_external_events <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span><span class="op">)</span>, t_external_durations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>t_start <span class="op">=</span> <span class="fl">0</span>, t_end <span class="op">=</span> <span class="fl">1500</span>, t_step <span class="op">=</span> <span class="fl">0.01</span>,</span></span>
<span class="r-in"><span>t_store <span class="op">=</span> <span class="fl">1500</span>, stochastic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Karoline Faust, Yu Gao, Emma Gheysen, Daniel Rios Garza, Yagmur Simsek, Leo Lahti.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer></div>

  


  

  </body></html>

