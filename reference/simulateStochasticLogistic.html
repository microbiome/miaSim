<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Stochastic Logistic simulation — simulateStochasticLogistic • miaSim</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Stochastic Logistic simulation — simulateStochasticLogistic"><meta name="description" content="Simulates time series with the (stochastic) logistic model"><meta property="og:description" content="Simulates time series with the (stochastic) logistic model"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">miaSim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.9.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/miaSim.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/microbiome/miaSim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Stochastic Logistic simulation</h1>
      <small class="dont-index">Source: <a href="https://github.com/microbiome/miaSim/blob/harm/R/simulateStochasticLogistic.R" class="external-link"><code>R/simulateStochasticLogistic.R</code></a></small>
      <div class="d-none name"><code>simulateStochasticLogistic.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulates time series with the (stochastic) logistic model</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simulateStochasticLogistic</span><span class="op">(</span></span>
<span>  <span class="va">n_species</span>,</span>
<span>  names_species <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  growth_rates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  carrying_capacities <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  death_rates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigma_drift <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  sigma_epoch <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  sigma_external <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  sigma_migration <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  epoch_p <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  t_external_events <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  t_external_durations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  migration_p <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  metacommunity_probability <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stochastic <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  error_variance <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  norm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  t_end <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n-species">n_species<a class="anchor" aria-label="anchor" href="#arg-n-species"></a></dt>
<dd><p>Integer: number of species</p></dd>


<dt id="arg-names-species">names_species<a class="anchor" aria-label="anchor" href="#arg-names-species"></a></dt>
<dd><p>Character: names of species. If NULL,
<code>paste0("sp", seq_len(n_species))</code> is used.
(default: <code>names_species = NULL</code>)</p></dd>


<dt id="arg-growth-rates">growth_rates<a class="anchor" aria-label="anchor" href="#arg-growth-rates"></a></dt>
<dd><p><code>Numeric scalar</code>. Specifies the growth rates
of simulated species. If NULL, <code>runif(n = n_species, min = 0.1, max = 0.2)</code>
is used. (Default: <code>NULL</code>)</p></dd>


<dt id="arg-carrying-capacities">carrying_capacities<a class="anchor" aria-label="anchor" href="#arg-carrying-capacities"></a></dt>
<dd><p><code>Numeric scalar</code>. Indicates the max
population of species supported in the community. If NULL,
<code>runif(n = n_species, min = 1000, max = 2000)</code> is used.
(Default: <code>NULL</code>)</p></dd>


<dt id="arg-death-rates">death_rates<a class="anchor" aria-label="anchor" href="#arg-death-rates"></a></dt>
<dd><p><code>Numeric scalar</code>. Indicates the death rates
of each species. If NULL, <code>runif(n = n_species, min = 0.0005, max = 0.0025)</code>
is used. (Default: <code>NULL</code>)</p></dd>


<dt id="arg-x-">x0<a class="anchor" aria-label="anchor" href="#arg-x-"></a></dt>
<dd><p><code>Numeric scalar</code>. Indicates the initial abundances of simulated
species. If NULL,  <code>runif(n = n_species, min = 0.1, max = 10)</code> is used.
(Default: <code>NULL</code>)</p></dd>


<dt id="arg-sigma-drift">sigma_drift<a class="anchor" aria-label="anchor" href="#arg-sigma-drift"></a></dt>
<dd><p>Numeric: standard deviation of a normally distributed
noise applied in each time step (t_step)
(default: <code>sigma_drift = 0.001</code>)</p></dd>


<dt id="arg-sigma-epoch">sigma_epoch<a class="anchor" aria-label="anchor" href="#arg-sigma-epoch"></a></dt>
<dd><p>Numeric: standard deviation of a normally distributed
noise applied to random periods of the community composition with frequency
defined by the epoch_p parameter
(default: <code>sigma_epoch = 0.1</code>)</p></dd>


<dt id="arg-sigma-external">sigma_external<a class="anchor" aria-label="anchor" href="#arg-sigma-external"></a></dt>
<dd><p>Numeric: standard deviation of a normally distributed
noise applied to user-defined external events/disturbances
(default: <code>sigma_external = 0.3</code>)</p></dd>


<dt id="arg-sigma-migration">sigma_migration<a class="anchor" aria-label="anchor" href="#arg-sigma-migration"></a></dt>
<dd><p>Numeric: standard deviation of a normally distributed
variable that defines the intensity of migration at each time step (t_step)
(default: <code>sigma_migration = 0.01</code>)</p></dd>


<dt id="arg-epoch-p">epoch_p<a class="anchor" aria-label="anchor" href="#arg-epoch-p"></a></dt>
<dd><p>Numeric: the probability/frequency of random periodic
changes introduced to the community composition
(default: <code>epoch_p = 0.001</code>)</p></dd>


<dt id="arg-t-external-events">t_external_events<a class="anchor" aria-label="anchor" href="#arg-t-external-events"></a></dt>
<dd><p>Numeric: the starting time points of defined
external events that introduce random changes to the community composition
(default: <code>t_external_events = NULL</code>)</p></dd>


<dt id="arg-t-external-durations">t_external_durations<a class="anchor" aria-label="anchor" href="#arg-t-external-durations"></a></dt>
<dd><p>Numeric: respective duration of the external
events that are defined in the 't_external_events' (times) and
sigma_external (std).
(default: <code>t_external_durations = NULL</code>)</p></dd>


<dt id="arg-migration-p">migration_p<a class="anchor" aria-label="anchor" href="#arg-migration-p"></a></dt>
<dd><p>Numeric: the probability/frequency of migration from a
metacommunity.
(default: <code>migration_p = 0.01</code>)</p></dd>


<dt id="arg-metacommunity-probability">metacommunity_probability<a class="anchor" aria-label="anchor" href="#arg-metacommunity-probability"></a></dt>
<dd><p>Numeric: Normalized probability distribution
of the likelihood that species from the metacommunity can enter the community
during the simulation. If NULL, <code>rdirichlet(1, alpha = rep(1,n_species))</code> is
used.
(default: <code>metacommunity_probability = NULL</code>)</p></dd>


<dt id="arg-stochastic">stochastic<a class="anchor" aria-label="anchor" href="#arg-stochastic"></a></dt>
<dd><p><code>Logical scalar</code>. Whether to introduce noise in the simulation.
If False, sigma_drift, sigma_epoch, and sigma_external are ignored.
(Default: <code>TRUE</code>)</p></dd>


<dt id="arg-error-variance">error_variance<a class="anchor" aria-label="anchor" href="#arg-error-variance"></a></dt>
<dd><p>Numeric: the variance of measurement error.
By default it equals to 0, indicating that the result won't contain any
measurement error. This value should be non-negative.
(default: <code>error_variance = 0</code>)</p></dd>


<dt id="arg-norm">norm<a class="anchor" aria-label="anchor" href="#arg-norm"></a></dt>
<dd><p>Logical: whether the time series should be returned with
the abundances as proportions (<code>norm = TRUE</code>) or
the raw counts (default: <code>norm = FALSE</code>)
(default: <code>norm = FALSE</code>)</p></dd>


<dt id="arg-t-end">t_end<a class="anchor" aria-label="anchor" href="#arg-t-end"></a></dt>
<dd><p>Numeric: the end time of the simulationTimes, defining the
modeled time length of the community.
(default: <code>t_end = 1000</code>)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional parameters, see <code><a href="https://rdrr.io/r/utils/utils-package.html" class="external-link">utils</a></code> to know more.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>simulateStochasticLogistic</code> returns a TreeSummarizedExperiment
class object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The change rate of the species was defined as
<code>dx/dt = b*x*(1-(x/k))*rN - dr*x</code>, where
b is the vector of growth rates,
x is the vector of initial species abundances,
k is the vector of maximum carrying capacities,
rN is a random number ranged from 0 to 1 which changes in each time step,
dr is the vector of constant death rates.
Also, the vectors of initial dead species abundances can be set.
The number of species will be set to 0 if the dead species abundances
surpass the alive species abundances.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example of logistic model without stochasticity, death rates, or external</span></span></span>
<span class="r-in"><span><span class="co"># disturbances</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="fu">simulateStochasticLogistic</span><span class="op">(</span></span></span>
<span class="r-in"><span>    n_species <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>    stochastic <span class="op">=</span> <span class="cn">FALSE</span>, death_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Adding a death rate</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tse1</span> <span class="op">&lt;-</span> <span class="fu">simulateStochasticLogistic</span><span class="op">(</span></span></span>
<span class="r-in"><span>    n_species <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>    stochastic <span class="op">=</span> <span class="cn">FALSE</span>, death_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example of stochastic logistic model with measurement error</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tse2</span> <span class="op">&lt;-</span> <span class="fu">simulateStochasticLogistic</span><span class="op">(</span></span></span>
<span class="r-in"><span>    n_species <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>    error_variance <span class="op">=</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example with all the initial parameters defined by the user</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tse3</span> <span class="op">&lt;-</span> <span class="fu">simulateStochasticLogistic</span><span class="op">(</span></span></span>
<span class="r-in"><span>    n_species <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    names_species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species1"</span>, <span class="st">"species2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    growth_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    carrying_capacities <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">2000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    death_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.0015</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    sigma_drift <span class="op">=</span> <span class="fl">0.001</span>,</span></span>
<span class="r-in"><span>    sigma_epoch <span class="op">=</span> <span class="fl">0.3</span>,</span></span>
<span class="r-in"><span>    sigma_external <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>    sigma_migration <span class="op">=</span> <span class="fl">0.002</span>,</span></span>
<span class="r-in"><span>    epoch_p <span class="op">=</span> <span class="fl">0.001</span>,</span></span>
<span class="r-in"><span>    t_external_events <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    t_external_durations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    migration_p <span class="op">=</span> <span class="fl">0.01</span>,</span></span>
<span class="r-in"><span>    metacommunity_probability <span class="op">=</span> <span class="fu">miaSim</span><span class="fu">::</span><span class="fu"><a href="rdirichlet.html">rdirichlet</a></span><span class="op">(</span><span class="fl">1</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    stochastic <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    error_variance <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    norm <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># TRUE,</span></span></span>
<span class="r-in"><span>    t_end <span class="op">=</span> <span class="fl">400</span>,</span></span>
<span class="r-in"><span>    t_start <span class="op">=</span> <span class="fl">0</span>, t_step <span class="op">=</span> <span class="fl">0.01</span>,</span></span>
<span class="r-in"><span>    t_store <span class="op">=</span> <span class="fl">1500</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yagmur Simsek, Karoline Faust, Yu Gao, Emma Gheysen, Daniel Rios Garza, Tuomas Borman, Leo Lahti.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

